{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h2>Admin Dashboard</h2>
  <a href="{{ url_for('main.addproduct') }}" class="btn btn-primary mb-3">Add New Product</a>

  <div class="row">
    {% for product in products %}
    <div class="col-md-3">
      <div class="card mb-3 h-50">
        <!-- Product Image -->
        <img src="{% if product.image %}
                     {{ url_for('static', filename='uploads/' ~ product.image) }}
                   {% else %}
                     {{ url_for('static', filename='placeholder.png') }}
                   {% endif %}" 
             class="card-img-top" alt="{{ product.name }}" style="height:180px; object-fit:cover;">

        <!-- Product Details -->
        <div class="card-body">
          <h5 class="card-title">{{ product.name }}</h5>
          <p><strong>${{ product.price }}</strong></p>

          <!-- Short Description with Read More -->
          <p class="card-text">
            {{ product.description[:50] }}{% if product.description|length > 50 %}...
            <a href="#" class="text-primary read-more" data-full="{{ product.description }}">Read More</a>
            {% endif %}
          </p>

          <!-- Delete Button -->
          <form action="{{ url_for('main.delete_product', product_id=product.id) }}" 
                method="POST" style="display:inline;">
            <button type="submit" class="btn btn-danger btn-sm btn-fluid">Delete</button>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- JS for Read More toggle -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".read-more").forEach(link => {
      link.addEventListener("click", e => {
        e.preventDefault();
        const fullText = link.getAttribute("data-full");
        link.parentElement.innerHTML = fullText; // Replace with full description
      });
    });
  });
</script>
{% endblock %}
